<div class="max-w-7xl mx-auto mt-6 bg-white p-6 rounded-xl shadow space-y-6">

    <!-- üîç Recherche -->
    <div class="relative w-full max-w-md">
        <input type="text" [value]="searchQuery" #searchInput (input)="onSearchChange(searchInput.value)"
            placeholder="Rechercher un produit..." class="w-full pl-10 pr-4 py-2 border rounded-lg shadow-sm
             focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <svg class="absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg"
            fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round"
                d="M21 21l-4.35-4.35M17 10a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
    </div>

    <!-- üéØ Header actions -->
    <div class="flex justify-between items-center flex-wrap gap-4">
        <h2 class="text-xl font-semibold text-gray-700">üë• Liste des employ√©s</h2>

        <div class="flex gap-3 items-center">
            <input type="file" accept=".xlsx, .xls" (change)="onFileSelected($event)"
                class="border p-2 rounded-lg text-sm" />

            <button (click)="openAddModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                ‚ûï Ajouter
            </button>
        </div>
    </div>

    <!-- üì• APER√áU IMPORT EXCEL -->
    <div *ngIf="preview.length > 0" class="overflow-x-auto border rounded-xl shadow">
        <h3 class="p-4 font-semibold bg-blue-50 text-gray-700">
            üì• Aper√ßu des donn√©es import√©es
        </h3>

        <table class="min-w-[1000px] w-full text-sm border-collapse">
            <thead class="bg-gray-100 text-xs uppercase">
                <tr>
                    <th class="p-3">Agent ID</th>
                    <th class="p-3">Matricule</th>
                    <th class="p-3">Nom</th>
                    <th class="p-3">Sexe</th>
                    <th class="p-3">Naissance</th>
                    <th class="p-3">Ville</th>
                    <th class="p-3">T√©l√©phone</th>
                    <th class="p-3">Email</th>
                    <th class="p-3">Poste</th>
                    <th class="p-3">Contrat</th>
                    <th class="p-3">Statut</th>
                    <th class="p-3 text-center">D√©tails</th>
                </tr>
            </thead>

            <tbody>
                <tr *ngFor="let e of preview" class="border-t hover:bg-gray-50">
                    <td class="p-3">{{ e.agentId }}</td>
                    <td class="p-3">{{ e.matricule }}</td>
                    <td class="p-3">{{ e.prenom }} {{ e.nom }}</td>
                    <td class="p-3">{{ e.sexe }}</td>
                    <td class="p-3">{{ e.dateNaissance | date:'dd/MM/yyyy' }}</td>
                    <td class="p-3">{{ e.ville }}</td>
                    <td class="p-3">{{ e.telephone1 }}</td>
                    <td class="p-3">{{ e.email }}</td>
                    <td class="p-3">{{ e.poste }}</td>
                    <td class="p-3">{{ e.typeContrat }}</td>
                    <td class="p-3 font-semibold" [ngClass]="{
                'text-green-600': e.statut === 'ACTIF',
                'text-yellow-600': e.statut === 'Pause',
                'text-red-600': e.statut === 'Sortie'
              }">
                        {{ e.statut }}
                    </td>
                    <td class="p-3 text-center">
                        <button (click)="viewDetails(e)">üìã</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="p-4 text-right bg-gray-50">
            <button (click)="importerDepuisExcel()"
                class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
                ‚úî Importer
            </button>
        </div>
    </div>

    <!-- üìã TABLE EMPLOY√âS -->
    <div class="overflow-x-auto">
        <table class="min-w-[1400px] w-full text-sm border-collapse">
            <thead class="bg-gray-100 text-xs uppercase">
                <tr>
                    <th class="p-3">Photo</th>
                    <th class="p-3">Agent ID</th>
                    <th class="p-3">Matricule</th>
                    <th class="p-3">Nom</th>
                    <th class="p-3">Sexe</th>
                    <th class="p-3">Naissance</th>
                    <th class="p-3">Ville</th>
                    <th class="p-3">T√©l√©phone</th>
                    <th class="p-3">Poste</th>
                    <th class="p-3">Contrat</th>
                    <th class="p-3">Statut</th>
                    <th class="p-3 text-center">Actions</th>
                </tr>
            </thead>

            <tbody>
                <tr *ngFor="let e of employeComplet" class="border-t hover:bg-gray-50">
                    <td class="p-3">
                        <img [src]="baseUrl + '/api/employe-complet/image/' + e.agentId"
                            class="w-20 h-20 object-cover rounded-lg" />
                    </td>

                    <td class="p-3 font-medium">{{ e.agentId }}</td>
                    <td class="p-3">{{ e.matricule }}</td>
                    <td class="p-3">{{ e.prenom }} {{ e.nom }}</td>
                    <td class="p-3">{{ e.sexe }}</td>
                    <td class="p-3">{{ e.dateNaissance | date:'dd/MM/yyyy' }}</td>
                    <td class="p-3">{{ e.ville }}</td>
                    <td class="p-3">{{ e.telephone1 }}</td>
                    <td class="p-3">{{ e.poste }}</td>
                    <td class="p-3">{{ e.typeContrat }}</td>

                    <td class="p-3 font-semibold" [ngClass]="{
                'text-green-600': e.statut === 'ACTIF',
                'text-yellow-600': e.statut === 'Pause',
                'text-red-600': e.statut === 'Sortie'
              }">
                        {{ e.statut }}
                    </td>

                    <td class="p-3 flex justify-center gap-3">
                        <button (click)="editEmploye(e)" class="text-blue-600 text-xl">‚úèÔ∏è</button>
                        <button (click)="deleteRow(e.matricule)" class="text-red-600 text-xl">üóë</button>
                        <button (click)="viewDetails(e)" class="text-gray-600 text-xl">üìã</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="flex justify-between items-center text-sm mt-4">
        <button (click)="prevPage()" [disabled]="page === 0" class="px-3 py-1 border rounded disabled:opacity-50">‚óÄ
            Pr√©c√©dent</button>

        <span>Page <strong>{{ page + 1 }}</strong> / {{ totalPages || 1 }}</span>

        <button (click)="nextPage()" [disabled]="page + 1 >= totalPages"
            class="px-3 py-1 border rounded disabled:opacity-50">Suivant ‚ñ∂</button>
    </div>

    <!-- Aucun r√©sultat -->
    <div *ngIf="!loading && employeComplet.length === 0" class="text-center text-gray-400 text-2xl mt-10">
        Aucun employ√© trouv√©
    </div>

</div>